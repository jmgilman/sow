# Test session-info command with an active project
# Should show repository info and project details

exec git init

-- .sow/.version --
1.0.0

-- .sow/refs/index.json --
{
  "version": "1.0.0",
  "refs": []
}

-- .sow/project/state.yaml --
project:
  name: test-project
  branch: main
  description: A test project for session-info
  created_at: 2025-10-16T10:00:00Z
  updated_at: 2025-10-16T10:00:00Z
phases:
  discovery:
    status: skipped
    enabled: false
    created_at: 2025-10-16T10:00:00Z
    started_at: null
    completed_at: null
    discovery_type: null
    artifacts: []
  design:
    status: skipped
    enabled: false
    created_at: 2025-10-16T10:00:00Z
    started_at: null
    completed_at: null
    architect_used: null
    artifacts: []
  implementation:
    status: in_progress
    enabled: true
    created_at: 2025-10-16T10:00:00Z
    started_at: 2025-10-16T10:00:00Z
    completed_at: null
    planner_used: null
    tasks: []
    pending_task_additions: null
  review:
    status: pending
    enabled: true
    created_at: 2025-10-16T10:00:00Z
    started_at: null
    completed_at: null
    iteration: 1
    reports: []
  finalize:
    status: pending
    enabled: true
    created_at: 2025-10-16T10:00:00Z
    started_at: null
    completed_at: null
    project_deleted: false
    pr_url: null

# Run session-info
exec sow session-info
stdout '"type": "project"'
stdout '"root":'
stdout '"branch":'
stdout '"cli": "dev"'
stdout '"structure": "1.0.0"'
stdout '"mismatch": false'

# Should have project section
stdout '"project":'
stdout '"name": "test-project"'
stdout '"branch": "main"'
stdout '"description": "A test project for session-info"'
stdout '"current_phase": "implementation"'
stdout '"status": "in_progress"'

# Should have available commands including log
stdout 'sow log'
stdout 'sow validate'
